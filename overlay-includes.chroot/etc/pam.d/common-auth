# PAM configuration for authentication
#
# This file is configured to implement:
# - Account lockout after 3 failed attempts
# - 15-minute lockout duration 
# - Prevention of concurrent logins
# - Audit logging of authentication attempts

# Track failed attempts before authentication
auth      required      pam_faillock.so preauth silent audit deny=3 unlock_time=900

# Primary authentication
auth      [success=1 default=bad]      pam_unix.so try_first_pass

# Track failed attempts after failed authentication
auth      [default=die]      pam_faillock.so authfail audit deny=3 unlock_time=900

# Prevent concurrent logins 
auth      required      pam_limits.so conf=/etc/security/limits.d/max-logins.conf

# Display informative messages on failure
auth      optional      pam_echo.so file=/etc/security/auth_message

# The default is to let PAM modules complete successfully
auth      required      pam_deny.so

# Reset faillock counter after successful auth
auth      optional      pam_faillock.so authsucc audit

