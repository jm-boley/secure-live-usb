# Live Environment Sysctl Configuration

# Enable unprivileged user namespaces for container/sandbox functionality
# Overridden by 99-security-tuning.conf in the Security/Forensics branch
kernel.unprivileged_userns_clone = 1

# Core dump settings - allow with size and permission restrictions
kernel.core_uses_pid = 1
fs.suid_dumpable = 2
kernel.core_pipe_limit = 4

# Maintain ASLR (Address Space Layout Randomization)
kernel.randomize_va_space = 2

# Keep restrictions on dmesg but allow users to read system logs
kernel.dmesg_restrict = 1

# Maintain kexec restrictions (prevent system takeover via kexec)
kernel.kexec_load_disabled = 1

# Keep BPF JIT hardening enabled
net.core.bpf_jit_harden = 2

# Keep some memory protections but allow for debugging
vm.mmap_min_addr = 65536
vm.mmap_rnd_bits = 32
vm.mmap_rnd_compat_bits = 16

