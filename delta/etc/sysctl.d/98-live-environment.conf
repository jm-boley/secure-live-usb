# Live Environment Sysctl Configuration
# These settings override the default hardening configuration for Live environment compatibility

# Allow debugging tools to attach to processes owned by the same user
# More permissive than admin-only (2) but more secure than unrestricted (0)
kernel.yama.ptrace_scope = 1

# Enable unprivileged user namespaces for container/sandbox functionality
# Required for many development and testing tools
kernel.unprivileged_userns_clone = 1

# Core dump settings - allow with size and permission restrictions
kernel.core_pattern = |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h
kernel.core_uses_pid = 1
fs.suid_dumpable = 2
kernel.core_pipe_limit = 4

# Maintain ASLR (Address Space Layout Randomization)
kernel.randomize_va_space = 2

# Keep restrictions on dmesg but allow users to read system logs
kernel.dmesg_restrict = 1

# Maintain kexec restrictions (prevent system takeover via kexec)
kernel.kexec_load_disabled = 1

# Keep BPF JIT hardening enabled
net.core.bpf_jit_harden = 2

# Keep some memory protections but allow for debugging
vm.mmap_min_addr = 65536
vm.mmap_rnd_bits = 32
vm.mmap_rnd_compat_bits = 16

